<%# Inline chat panel — fetch-based chat with JSON endpoint.
    Locals:
      chat_endpoint:       String — URL to POST { message: text } to (required)
      chat_welcome:        Hash   — { intro:, outro: } for ds_chat_welcome (optional)
      chat_welcome_items:  Array  — [{ title:, description: }] for ds_chat_welcome items (optional)
%>
<div data-controller="inline-chat"
     data-inline-chat-endpoint-value="<%= chat_endpoint %>">
  <div class="flex flex-col" style="height: 400px;">
    <div class="flex-1 overflow-y-auto space-y-3 p-3 bg-gray-50 rounded-lg mb-3"
         data-inline-chat-target="messages">
      <% if local_assigns[:chat_welcome] %>
        <div data-inline-chat-target="welcome">
          <%= ds_chat_welcome(**chat_welcome) do |welcome| %>
            <% (local_assigns[:chat_welcome_items] || []).each do |item| %>
              <% welcome.with_item(title: item[:title], description: item[:description]) %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="flex items-center gap-2">
      <input type="text"
             placeholder="Type a message..."
             class="flex-1 rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
             autocomplete="off"
             data-inline-chat-target="input"
             data-action="keydown->inline-chat#keydown" />
      <%= ds_button(label: "Send", variant: :primary,
                    data: { action: "click->inline-chat#send",
                            inline_chat_target: "send" }) %>
    </div>
  </div>
</div>
